window.TranslateService=new class{allowLang=["ru","ua","pl","fr","en","de"];defaultLanguage="ru";langPath="./assets/i18n/";langButtons;locale={AT:"austria",BE:"belgium",DE:"germany",GR:"greece",IE:"ireland",ES:"spain",IT:"italy",CY:"cyprus",LV:"latvia",LT:"lithuania",LU:"luxembourg",MT:"malta",NL:"netherlands",PT:"portugal",SK:"slovakia",SI:"slovenia",FI:"finland",FR:"france",HR:"croatia",EE:"estonia",UK:"uk",US:"usa",CA:"canada"};constructor(){this.langButtons=document.querySelectorAll(".modal--lang .btn-primary"),this.langButtons.forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.closest(".btn-primary").getAttribute("lang");localStorage.setItem("garno_tech_language",e),this.changeLanguage(e);const a=t.target.closest(".modal--lang");a&&(a.classList.remove("modal--active"),document.body.style.overflow="auto")}))})),this.setupLanguage().then()}async setupLanguage(){const t=await this.getLocation();if(t&&t.country_code&&this.locale[t.country_code]){const e=document.getElementById("locale-title");e&&e.setAttribute("data-i18n",`hero.title.${this.locale[t.country_code]}`);const a=document.getElementById("locale-subtitle");a&&a.setAttribute("data-i18n",`hero.subtitle.${this.locale[t.country_code]}`);const n=document.getElementById("locale-projects");n&&n.setAttribute("data-i18n",`whyus.project.title.${this.locale[t.country_code]}`)}const e=localStorage.getItem("garno_tech_language"),a=navigator.language||navigator.userLanguage;if(e&&this.allowLang.includes(e))this.changeLanguage(e);else if(a){const t=this.allowLang.findIndex((t=>a.includes(t)));t>-1?this.changeLanguage(this.allowLang[t]):this.changeLanguage(this.defaultLanguage)}else this.changeLanguage(this.defaultLanguage)}async getLocation(){try{const t=await fetch("https://ipwho.is/");if(!t.ok)throw new Error(`Response status: ${t.status}`);return await t.json()}catch(t){}}getJSONUrl(t){return this.langPath+t+".json"}changeLanguage(t="en"){!t||this.allowLang.indexOf(t.toLowerCase())<=-1||(window.SelectedLanguage=t,this.langButtons.forEach((e=>{e.getAttribute("lang")===t?e.classList.add("btn-primary__lang-active"):e.classList.remove("btn-primary__lang-active")})),this.readTextFile(this.getJSONUrl(t),this.replaceLang))}readTextFile(t,e){const a=new XMLHttpRequest;a.overrideMimeType("application/json"),a.open("GET",t,!0),a.onreadystatechange=function(){4===a.readyState&&200===a.status&&e(a.responseText)},a.send(null)}replaceLang(t){try{const e=JSON.parse(t);document.querySelectorAll("[data-i18n]").forEach((function(t){if(e[t.dataset.i18n])if(t.dataset.i18n_target)t[t.dataset.i18n_target]=e[t.dataset.i18n];else switch(t.tagName.toLowerCase()){case"input":case"textarea":return void(t.placeholder=e[t.dataset.i18n]);case"meta":return void(t.content=e[t.dataset.i18n]);default:t.innerHTML=e[t.dataset.i18n]}}))}catch(t){console.log(t)}}};